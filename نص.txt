<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>إحصائيات التذاكر</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f7f7; direction:rtl; text-align:center; }
    .box { margin:50px auto; padding:30px; width:400px; background:#fff; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
    h1 { color:#333; }
    .ticket { margin:10px 0; padding:10px; border-radius:8px; }
    .available { background:#d4edda; color:#155724; }
    .soldout { background:#f8d7da; color:#721c24; }
  </style>
</head>
<body>
  <div class="box">
    <h1>🎟️ حالة التذاكر</h1>
    <div id="tickets">جاري تحميل البيانات...</div>
  </div>

  <script>
    async function loadTickets() {
      // يطلب البيانات من الكود الخلفي Flask
      const response = await fetch("/api/tickets");
      const data = await response.json();
      const container = document.getElementById("tickets");
      container.innerHTML = "";

      // يعرض كل تذكرة وحالتها
      data.forEach(ticket => {
        const div = document.createElement("div");
        div.className = "ticket " + (ticket.status === "متاحة" ? "available" : "soldout");
        div.textContent = ticket.name + " — " + ticket.status;
        container.appendChild(div);
      });
    }

    loadTickets();
    setInterval(loadTickets, 60000); // يحدث كل دقيقة
  </script>
</body>
</html>